#include <Rcpp.h>
#include <RcppEigen.h>
#include <math.h>

#define EIGEN_USE_BLAS
#define EIGEN_USE_LAPACKE
#define pi 3.141592653589793
#define s2pi 2.506628274631

// [[Rcpp::plugins("cpp11")]]
// [[Rcpp::depends(RcppEigen)]]

#include "factorial.h"
#include "pbdv.h"


template <typename T> int sign (T val) {
  return (T(0) < val) - (val < T(0));
}


// [[Rcpp::export]]

double rg3p (const double& a, const double& b, const int& c) 
{
  const double r = std::abs(b) / a;
  int rs;
  
  if (r <= 0.2) {
    rs = 1;
  } else if (r > 0.2 && r <= 0.4) {
    rs = 2;
  } else if (r > 0.4 && r <= 0.6) {
    rs = 3;
  } else if (r > 0.6 && r <= 0.8) {
    rs = 4;
  } else if (r > 0.8 && r <= 1) {
    rs = 5;
  } else if (r > 1 && r <= 1.5) {
    rs = 6;
  } else if (r > 1.5 && r <= 2) {
    rs = 7;
  } else if (r > 2 && r <= 2.5) {
    rs = 8;
  } else if (r > 2.5 && r <= 3) {
    rs = 9;
  } else if (r > 3 && r <= 3.5) {
    rs = 10;
  } else if (r > 3.5 && r <= 4) {
    rs = 11;
  } else if (r > 4 && r <= 4.5) {
    rs = 12;
  } else if (r > 4.5 && r <= 5) {
    rs = 13;
  } else {
    rs = 0;
  }
  
  double out;
  
  if (c > 14) 
  {
    const double ts = std::sqrt(2.0) * a;
    const double t = -b / ts;
    
    const double q = -t + 0.5 * (t + sqrt(t * t + 4 * c + 2));
    const double w = -t + 0.5 * (t + sqrt(t * t + 4 * (c+1) + 2));
    
    const double mu = q / ts;
    const double s2 = q * (w - q) / (ts * ts);
    
    out = R::rnorm(mu, sqrt(s2));
    while (out <= 0.0)
      out = R::rnorm(mu, sqrt(s2));  

    return out;
  }
  
  if (b < 0.0) {
    
    // :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    // case b < 0: Gamma approximation
    
    if (r >= 20) 
    {
      // approximated parameters
      // const double u = std::abs(b);
      // const double q = (double)c + 1.0;
      
      out = R::rgamma((double)c + 1.0, 1.0 / std::abs(b));
      return out;
    } 
    else if (r >= 5)
    {
      // exact parameters
      const double ts = std::sqrt(2.0) * a;
      const double t = -b / ts;
      
      const double d21 = pbdv(-c-2, t) / pbdv(-c-1, t);
      const double d31 = (1.0 - t * d21) / (c+2);
      
      const double mu = (c+1) / ts * d21;
      const double s2 = (c+1) * (c+2) / (ts * ts) * d31 - mu * mu;  
      
      const double u = mu / s2;
      out = R::rgamma(u * mu, 1.0 / u);
      return out;
    }
    else 
    {
      // Exact sampling
      double xs1 = 0.0, xs2 = 0.0, ds = 0.0, bs = 0.0, cs = 0.0;
      
      switch(c) 
      {
        // :::: case c = 1
      case 1:
        
        switch(rs) {
        case 1:
          xs1 = -1.5305156071382; xs2 = 0.912689119744102;
          ds = 0.655348065027528; bs = -0.4964561; cs = 0.690138935200033;
          break; 
        case 2:
          xs1 = -1.52631273299577; xs2 = 0.929115435735049;
          ds = 0.659234853596739; bs = -0.5028346; cs = 0.73468663501275;
          break; 
        case 3:
          xs1 = -1.52162340688057; xs2 = 0.94628704376105;
          ds = 0.662997556152702; bs = -0.5085152; cs = 0.779040199076203;
          break; 
        case 4:
          xs1 = -1.51659405713692; xs2 = 0.964115091624826;
          ds = 0.666656721660187; bs = -0.5135407; cs = 0.822936278311114;
          break; 
        case 5:
          xs1 = -1.51135018545505; xs2 = 0.982514613033376;
          ds = 0.670231423536598; bs = -0.5179581; cs = 0.86613962768219;
          break; 
        case 6:
          xs1 = -1.49794734172668; xs2 = 1.00140519421345;
          ds = 0.678903806481405; bs = -0.5240614; cs = 0.969856251460308;
          break; 
        case 7:
          xs1 = -1.48498179745043; xs2 = 1.05029781972212;
          ds = 0.687345894831465; bs = -0.530846; cs = 1.06573016608705;
          break; 
        case 8:
          xs1 = -1.47308147718974; xs2 = 1.10076692992126;
          ds = 0.695664093100522; bs = -0.5353669; cs = 1.15257389067033;
          break; 
        case 9:
          xs1 = -1.46251252652624; xs2 = 1.15197785672063;
          ds = 0.703896084751363; bs = -0.5382237; cs = 1.23008749716618;
          break; 
        case 10:
          xs1 = -1.45332293238867; xs2 = 1.20327937182714;
          ds = 0.712036465716239; bs = -0.5398922; cs = 1.29857308211284;
          break; 
        case 11:
          xs1 = -1.44544184030771; xs2 = 1.25417822831087;
          ds = 0.720058127965459; bs = -0.5407328; cs = 1.35868596210447;
          break; 
        case 12:
          xs1 = -1.43874240881106; xs2 = 1.30431194740893;
          ds = 0.727926692044799; bs = -0.5410095; cs = 1.41124992334575;
          break; 
        case 13:
          xs1 = -1.43307882982896; xs2 = 1.35342319244879;
          ds = 0.735608926519893; bs = -0.5409117; cs = 1.45713471624584;
          break;
        }
        
        break; 
        
        // :::: case c = 2
      case 2:
        
        switch(rs) {
        case 1:
          xs1 = -1.46762675002325; xs2 = 0.966780987567261;
          ds = 0.640850773323764; bs = -0.3709062; cs = 0.612807824732429;
          break; 
        case 2:
          xs1 = -1.4728963108979; xs2 = 0.97880554716401;
          ds = 0.645409185607863; bs = -0.3709062; cs = 0.644858572756784;
          break; 
        case 3:
          xs1 = -1.47763762926207; xs2 = 0.991424959046815;
          ds = 0.649910633567843; bs = -0.3763118; cs = 0.677029250038188;
          break; 
        case 4:
          xs1 = -1.481893497323; xs2 = 1.00459391018882;
          ds = 0.654351410094055; bs = -0.3813603; cs = 0.709182798902901;
          break; 
        case 5:
          xs1 = -1.48570861883742; xs2 = 1.01826609548042;
          ds = 0.658729163202931; bs = -0.3860573; cs = 0.741189229048978;
          break; 
        case 6:
          xs1 = -1.48912806794888; xs2 = 1.03239496947775;
          ds = 0.669391587385406; bs = -0.3932474; cs = 0.819793410806994;
          break; 
        case 7:
          xs1 = -1.49623091373003; xs2 = 1.0694147604818;
          ds = 0.679653685995181; bs = -0.4021559; cs = 0.895161877519179;
          break; 
        case 8:
          xs1 = -1.5017592316066; xs2 = 1.10831582025432;
          ds = 0.689529267116977; bs = -0.4092936; cs = 0.966167443852901;
          break; 
        case 9:
          xs1 = -1.50622278129593; xs2 = 1.14848027600128;
          ds = 0.699035066248505; bs = -0.4149169; cs = 1.03212810313543;
          break; 
        case 10:
          xs1 = -1.51000361537153; xs2 = 1.18937659569586;
          ds = 0.708185379582474; bs = -0.4192792; cs = 1.09273893748906;
          break; 
        case 11:
          xs1 = -1.51337001476589; xs2 = 1.23056330730313;
          ds = 0.716990795468603; bs = -0.4226126; cs = 1.1479832249609;
          break; 
        case 12:
          xs1 = -1.51649970317986; xs2 = 1.27168450209176;
          ds = 0.72545892290024; bs = -0.4251197; cs = 1.19804475712938;
          break; 
        case 13:
          xs1 = -1.5195036064406; xs2 = 1.31246095144929;
          ds = 0.73359573025022; bs = -0.4269709; cs = 1.2432331387979;
          break;
        }
        
        break; 
        
        // :::: case c = 3
      case 3:
        
        switch(rs) {
        case 1:
          xs1 = -1.42055718819567; xs2 = 0.996965522025967;
          ds = 0.632575607437194; bs = -0.299592; cs = 0.583087203041517;
          break; 
        case 2:
          xs1 = -1.42757891082073; xs2 = 1.00686965832437;
          ds = 0.636901804960839; bs = -0.3043217; cs = 0.609174546938922;
          break; 
        case 3:
          xs1 = -1.4343072609836; xs2 = 1.01723669018021;
          ds = 0.641220703122158; bs = -0.3088456; cs = 0.635425948112241;
          break; 
        case 4:
          xs1 = -1.44074821297429; xs2 = 1.02804113926714;
          ds = 0.645524900546571; bs = -0.3131592; cs = 0.661756253337192;
          break; 
        case 5:
          xs1 = -1.44691055632763; xs2 = 1.03925595096508;
          ds = 0.649807827420609; bs = -0.3172597; cs = 0.688082632692102;
          break; 
        case 6:
          xs1 = -1.45280529893961; xs2 = 1.05085294176035;
          ds = 0.66038606535381; bs = -0.323783; cs = 0.753371257279186;
          break; 
        case 7:
          xs1 = -1.46645711245964; xs2 = 1.08132709872188;
          ds = 0.670726608358925; bs = -0.3321923; cs = 0.817043925383035;
          break; 
        case 8:
          xs1 = -1.47873802518872; xs2 = 1.11355451200082;
          ds = 0.680782108787308; bs = -0.3393585; cs = 0.878218674443403;
          break; 
        case 9:
          xs1 = -1.48987298208639; xs2 = 1.14709701038746;
          ds = 0.690522578543672; bs = -0.3453844; cs = 0.936258504051451;
          break; 
        case 10:
          xs1 = -1.50006742413647; xs2 = 1.18155209022391;
          ds = 0.699930269396855; bs = -0.3503925; cs = 0.99075929408914;
          break;
        case 11:
          xs1 = -1.50949543261665; xs2 = 1.21656408686266;
          ds = 0.708995887846626; bs = -0.3545116; cs = 1.0415177994386;
          break; 
        case 12:
          xs1 = -1.51829705043043; xs2 = 1.25182852519337;
          ds = 0.717716025729684; bs = -0.3578674; cs = 1.08849085930907;
          break; 
        case 13:
          xs1 = -1.5265808947111; xs2 = 1.28709171959574;
          ds = 0.726091491801687; bs = -0.3605767; cs = 1.13175402560189;
          break;
        }
        
        break;
        
        // :::: case c = 4
      case 4:
        
        switch(rs) {
        case 1:
          xs1 = -1.38886719533631; xs2 = 1.01678371091048;
          ds = 0.627474921341081; bs = -0.2593074; cs = 0.567391589348986;
          break; 
        case 2:
          xs1 = -1.39611064298586; xs2 = 1.02540624333358;
          ds = 0.631475361184467; bs = -0.263237; cs = 0.589881586406355;
          break; 
        case 3:
          xs1 = -1.40319432223399; xs2 = 1.03440090317761;
          ds = 0.635491532596817; bs = -0.2670359; cs = 0.61253417467409;
          break; 
        case 4:
          xs1 = -1.41011428241032; xs2 = 1.04375169911863;
          ds = 0.639516473738019; bs = -0.2706988; cs = 0.635290546735958;
          break; 
        case 5:
          xs1 = -1.41686845218102; xs2 = 1.0534412572503;
          ds = 0.643543634739584; bs = -0.2742217; cs = 0.658092714364293;
          break; 
        case 6:
          xs1 = -1.42345643568953; xs2 = 1.06345108073995;
          ds = 0.653582271514012; bs = -0.2799463; cs = 0.714933080293891;
          break; 
        case 7:
          xs1 = -1.43920927323521; xs2 = 1.08974824192202;
          ds = 0.663514830932068; bs = -0.2874905; cs = 0.770897378694974;
          break; 
        case 8:
          xs1 = -1.4539793275841; xs2 = 1.11760930907007;
          ds = 0.673275666509232; bs = -0.2941412; cs = 0.825294491214914;
          break; 
        case 9:
          xs1 = -1.46784061730052; xs2 = 1.14671541247997;
          ds = 0.682814882871697; bs = -0.2999363; cs = 0.877580274141161;
          break; 
        case 10:
          xs1 = -1.48087892927724; xs2 = 1.17676005570829;
          ds = 0.692096033493349; bs = -0.3049343; cs = 0.927361572202822;
          break;
        case 11:
          xs1 = -1.49318040587869; xs2 = 1.20746028112072;
          ds = 0.701093714175185; bs = -0.3092058; cs = 0.974385922630949;
          break; 
        case 12:
          xs1 = -1.5048247698269; xs2 = 1.23856326266359;
          ds = 0.709791370516074; bs = -0.3128273; cs = 1.01852248279108;
          break; 
        case 13:
          xs1 = -1.51588214236479; xs2 = 1.26984920977083;
          ds = 0.718179439810287; bs = -0.3158753; cs = 1.05973909115003;
          break;
        }
        
        break; 
        
        // :::: case c = 5
      case 5:
        
        switch(rs) {
        case 1:
          xs1 = -1.36624293193535; xs2 = 1.03107527484378;
          ds = 0.624054278016156; bs = -0.2315614; cs = 0.55765543939415;
          break; 
        case 2:
          xs1 = -1.37330437564338; xs2 = 1.03881960445044;
          ds = 0.627757661972631; bs = -0.2348987; cs = 0.577691934326543;
          break; 
        case 3:
          xs1 = -1.38028060296226; xs2 = 1.04687265878939;
          ds = 0.63148714341238; bs = -0.2381464; cs = 0.597880062328808;
          break; 
        case 4:
          xs1 = -1.38716525042542; xs2 = 1.05522352455269;
          ds = 0.63523683049441; bs = -0.2412997; cs = 0.618176315003628;
          break; 
        case 5:
          xs1 = -1.39395311030608; xs2 = 1.06386017577157;
          ds = 0.639001018348177; bs = -0.2443547; cs = 0.638537435713821;
          break; 
        case 6:
          xs1 = -1.40064007044682; xs2 = 1.07276963151402;
          ds = 0.648439588234205; bs = -0.2493864; cs = 0.689447545088018;
          break; 
        case 7:
          xs1 = -1.41689800764943; xs2 = 1.09614486132505;
          ds = 0.657856915516217; bs = -0.2561121; cs = 0.739872555882256;
          break; 
        case 8:
          xs1 = -1.43248372400601; xs2 = 1.12090778432992;
          ds = 0.667186085947483; bs = -0.2621721; cs = 0.789258891087623;
          break; 
        case 9:
          xs1 = -1.44739937231447; xs2 = 1.1468183664443;
          ds = 0.676371969248915; bs = -0.2675756; cs = 0.837147136183991;
          break; 
        case 10:
          xs1 = -1.46166506532421; xs2 = 1.17363827566854;
          ds = 0.685370683240377; bs = -0.2723492; cs = 0.883180427359957;
          break;
        case 11:
          xs1 = -1.47531129118316; xs2 = 1.20114028877657;
          ds = 0.694148521113313; bs = -0.2765315; cs = 0.92710295851888;
          break; 
        case 12:
          xs1 = -1.48837324107523; xs2 = 1.22911478930453;
          ds = 0.702680641178834; bs = -0.280169; cs = 0.968751410342607;
          break; 
        case 13:
          xs1 = -1.50088700454806; xs2 = 1.25737364841103;
          ds = 0.710949717409297; bs = -0.283312; cs = 1.00804218485247;
          break;
        }
        
        break; 
        
        // :::: case c = 6
      case 6:
        
        switch(rs) {
        case 1:
          xs1 = -1.34922478300165; xs2 = 1.0420198000211;
          ds = 0.621609500156627; bs = -0.211032; cs = 0.550999163270892;
          break; 
        case 2:
          xs1 = -1.35599789008388; xs2 = 1.04911419378331;
          ds = 0.625059399382344; bs = -0.2139232; cs = 0.569231012737893;
          break; 
        case 3:
          xs1 = -1.36272920457189; xs2 = 1.05647126269749;
          ds = 0.628539852553465; bs = -0.2167491; cs = 0.587602276316879;
          break; 
        case 4:
          xs1 = -1.3694121884277; xs2 = 1.06408308225564;
          ds = 0.632045967441784; bs = -0.2195058; cs = 0.606079181918344;
          break; 
        case 5:
          xs1 = -1.37604101212081; xs2 = 1.07194084166196;
          ds = 0.635572922111604; bs = -0.22219; cs = 0.624627974197354;
          break; 
        case 6:
          xs1 = -1.38261054696985; xs2 = 1.08003494474728;
          ds = 0.644450861326526; bs = -0.2266522; cs = 0.671096630510136;
          break; 
        case 7:
          xs1 = -1.39874740778361; xs2 = 1.10123538126633;
          ds = 0.653360365129231; bs = -0.232676; cs = 0.717306912777675;
          break; 
        case 8:
          xs1 = -1.41443526688953; xs2 = 1.12367308818952;
          ds = 0.662239068735253; bs = -0.238187; cs = 0.762805295291391;
          break; 
        case 9:
          xs1 = -1.42964309914742; xs2 = 1.14716168219554;
          ds = 0.671032953010015; bs = -0.2431817; cs = 0.807201685824344;
          break; 
        case 10:
          xs1 = -1.4443566978781; xs2 = 1.1715116094511;
          ds = 0.679696690014606; bs = -0.24767; cs = 0.850178412095085;
          break;
        case 11:
          xs1 = -1.45857416591364; xs2 = 1.1965376946825;
          ds = 0.688193406635787; bs = -0.2516726; cs = 0.891492343700398;
          break; 
        case 12:
          xs1 = -1.47230201100974; xs2 = 1.22206485689225;
          ds = 0.69649407242037; bs = -0.2552177; cs = 0.930971592441018;
          break; 
        case 13:
          xs1 = -1.48555206426887; xs2 = 1.24793201681056;
          ds = 0.70457668029907; bs = -0.2583384; cs = 0.96850849787697;
          break;
        }
        
        break; 
        
        // :::: case c = 7
      case 7:
        
        switch(rs) {
        case 1:
          xs1 = -1.33589453245392; xs2 = 1.05075677447043;
          ds = 0.619777982592505; bs = -0.1950799; cs = 0.54614224698776;
          break; 
        case 2:
          xs1 = -1.34236426024871; xs2 = 1.05734481560408;
          ds = 0.623013190855689; bs = -0.1976259; cs = 0.562977453661725;
          break; 
        case 3:
          xs1 = -1.34881861045293; xs2 = 1.06416083810575;
          ds = 0.62628001054304; bs = -0.2001223; cs = 0.579941193432657;
          break; 
        case 4:
          xs1 = -1.35525153022808; xs2 = 1.07119881237412;
          ds = 0.629575674584531; bs = -0.2025658; cs = 0.597005108201726;
          break; 
        case 5:
          xs1 = -1.36165740545343; xs2 = 1.07845199657877;
          ds = 0.632895344289016; bs = -0.2049537; cs = 0.614142658840365;
          break; 
        case 6:
          xs1 = -1.3680310717481; xs2 = 1.08591300435931;
          ds = 0.641273278417839; bs = -0.2089503; cs = 0.65713174139358;
          break; 
        case 7:
          xs1 = -1.3837945073326; xs2 = 1.10542131192086;
          ds = 0.64971553895946; bs = -0.2143849; cs = 0.70000257826285;
          break; 
        case 8:
          xs1 = -1.39926684387745; xs2 = 1.12604096492194;
          ds = 0.658165861695542; bs = -0.2194133; cs = 0.742376156619768;
          break; 
        case 9:
          xs1 = -1.41440259984974; xs2 = 1.14762334541945;
          ds = 0.666573780289796; bs = -0.2240263; cs = 0.783917907776451;
          break; 
        case 10:
          xs1 = -1.42917025144294; xs2 = 1.17001453378872;
          ds = 0.674895357531971; bs = -0.2282249; cs = 0.824346075717802;
          break;
        case 11:
          xs1 = -1.44354973500712; xs2 = 1.19306129694471;
          ds = 0.683093408900443; bs = -0.2320195; cs = 0.863435231393247;
          break; 
        case 12:
          xs1 = -1.45752997879424; xs2 = 1.21661591518605;
          ds = 0.691137345663155; bs = -0.2354269; cs = 0.901015676295037;
          break; 
        case 13:
          xs1 = -1.47110670680289; xs2 = 1.24053976553263;
          ds = 0.699002758528556; bs = -0.2384691; cs = 0.936969758286603;
          break;
        }
        
        break; 
        
        // :::: case c = 8
      case 8:
        
        switch(rs) {
        case 1:
          xs1 = -1.32512111561691; xs2 = 1.05794656297189;
          ds = 0.618353808549721; bs = -0.1822363; cs = 0.542431189617651;
          break; 
        case 2:
          xs1 = -1.33130186504942; xs2 = 1.06412544625259;
          ds = 0.621406394519465; bs = -0.1845087; cs = 0.558144909425392;
          break; 
        case 3:
          xs1 = -1.337483879246; xs2 = 1.0705053529579;
          ds = 0.624491367320192; bs = -0.1867421; cs = 0.573976494412147;
          break; 
        case 4:
          xs1 = -1.3436617417743; xs2 = 1.07708152690921;
          ds = 0.627604604771757; bs = -0.1889337; cs = 0.589904167573225;
          break; 
        case 5:
          xs1 = -1.34983030982548; xs2 = 1.0838486316464;
          ds = 0.630744127361874; bs = -0.1910812; cs = 0.605904003280968;
          break; 
        case 6:
          xs1 = -1.3559847309574; xs2 = 1.09080079771778;
          ds = 0.638681623322801; bs = -0.194694; cs = 0.646075517683684;
          break; 
        case 7:
          xs1 = -1.37127978844083; xs2 = 1.10894813202384;
          ds = 0.646703727131612; bs = -0.1996343; cs = 0.686219409298003;
          break; 
        case 8:
          xs1 = -1.38639618699519; xs2 = 1.12810139357553;
          ds = 0.654760259824785; bs = -0.2042452; cs = 0.726013533839031;
          break; 
        case 9:
          xs1 = -1.40128316592551; xs2 = 1.1481393964119;
          ds = 0.66280503196362; bs = -0.2085149; cs = 0.765167878270846;
          break; 
        case 10:
          xs1 = -1.41590105017816; xs2 = 1.16893485242122;
          ds = 0.670796708759741; bs = -0.2124402; cs = 0.803431983157799;
          break;
        case 11:
          xs1 = -1.43021998767729; xs2 = 1.19035913076196;
          ds = 0.678699264040689; bs = -0.216025; cs = 0.840598862082665;
          break; 
        case 12:
          xs1 = -1.44421849066472; xs2 = 1.21228627732929;
          ds = 0.686482096037029; bs = -0.219279; cs = 0.876505792485052;
          break; 
        case 13:
          xs1 = -1.45788197679606; xs2 = 1.23459617467097;
          ds = 0.694119886287676; bs = -0.2222168; cs = 0.911032595894479;
          break;
        }
        
        break; 
        
        // :::: case c = 9
      case 9:
        
        switch(rs) {
        case 1:
          xs1 = -1.31619730067439; xs2 = 1.06400169172524;
          ds = 0.617214673337533; bs = -0.1716141; cs = 0.539495243693712;
          break; 
        case 2:
          xs1 = -1.3221120677563; xs2 = 1.06984083303038;
          ds = 0.620110241370236; bs = -0.1736648; cs = 0.554283329913321;
          break; 
        case 3:
          xs1 = -1.32803886065736; xs2 = 1.07585950856398;
          ds = 0.623037651628616; bs = -0.1756839; cs = 0.56918043296773;
          break; 
        case 4:
          xs1 = -1.33397288383165; xs2 = 1.08205385848352;
          ds = 0.625993963832707; bs = -0.1776693; cs = 0.584167656554048;
          break; 
        case 5:
          xs1 = -1.33990951202644; xs2 = 1.0884195433416;
          ds = 0.628976205758164; bs = -0.1796187; cs = 0.599225958712876;
          break; 
        case 6:
          xs1 = -1.3458443077358; xs2 = 1.09495177826952;
          ds = 0.636525236261698; bs = -0.1829117; cs = 0.637058314276353;
          break; 
        case 7:
          xs1 = -1.36064600758354; xs2 = 1.11197604459383;
          ds = 0.6441720019061; bs = -0.1874344; cs = 0.674922909640527;
          break; 
        case 8:
          xs1 = -1.37535012083538; xs2 = 1.12991740506727;
          ds = 0.651871139360233; bs = -0.1916847; cs = 0.71254267641207;
          break; 
        case 9:
          xs1 = -1.3899051367345; xs2 = 1.14867516011568;
          ds = 0.659580729392868; bs = -0.1956501; cs = 0.749663683687047;
          break; 
        case 10:
          xs1 = -1.40426819412056; xs2 = 1.16814236044483;
          ds = 0.667262448549632; bs = -0.1993248; cs = 0.786062291355428;
          break;
        case 11:
          xs1 = -1.41840456117348; xs2 = 1.18820961971657;
          ds = 0.674882122588327; bs = -0.2027092; cs = 0.821549034136579;
          break; 
        case 12:
          xs1 = -1.43228684560954; xs2 = 1.2087684512945;
          ds = 0.682409995511996; bs = -0.2058083; cs = 0.855970102318588;
          break; 
        case 13:
          xs1 = -1.44589408504011; xs2 = 1.22971400825468;
          ds = 0.689820765828124; bs = -0.2086316; cs = 0.889206794103094;
          break;
        }
        
        break; 
        
        // :::: case c = 10
      case 10:
        
        switch(rs) {
        case 1:
          xs1 = -1.30865830907859; xs2 = 1.0691949744426;
          ds = 0.616282371627666; bs = -0.1626425; cs = 0.537109191435822;
          break; 
        case 2:
          xs1 = -1.31433124249177; xs2 = 1.07474601160817;
          ds = 0.619041512056498; bs = -0.1645103; cs = 0.551116708524562;
          break; 
        case 3:
          xs1 = -1.32002328069129; xs2 = 1.08045908575877;
          ds = 0.621831591668729; bs = -0.1663519; cs = 0.565225517232709;
          break; 
        case 4:
          xs1 = -1.32573018362028; xs2 = 1.08633099204992;
          ds = 0.624650075301423; bs = -0.1681656; cs = 0.579419412081127;
          break; 
        case 5:
          xs1 = -1.33144781538057; xs2 = 1.09235812385109;
          ds = 0.627494388410594; bs = -0.1699495; cs = 0.593682039902475;
          break; 
        case 6:
          xs1 = -1.33717216053762; xs2 = 1.09853649818343;
          ds = 0.634700530921942; bs = -0.1729726; cs = 0.629532386855637;
          break; 
        case 7:
          xs1 = -1.35148728784698; xs2 = 1.11461491877349;
          ds = 0.642011953947189; bs = -0.1771394; cs = 0.665456197051151;
          break; 
        case 8:
          xs1 = -1.36576405320838; xs2 = 1.13153492454962;
          ds = 0.649387956641158; bs = -0.1810772; cs = 0.701211923640174;
          break; 
        case 9:
          xs1 = -1.37995239935075; xs2 = 1.14921148832781;
          ds = 0.65679059272251; bs = -0.1847736; cs = 0.736575185041816;
          break; 
        case 10:
          xs1 = -1.39400897201592; xs2 = 1.16755350381042;
          ds = 0.664184572936973; bs = -0.1882216; cs = 0.771345238049633;
          break;
        case 11:
          xs1 = -1.40789703368173; xs2 = 1.18646686753547;
          ds =  0.671537846497217; bs = -0.1914191; cs = 0.805348637533689;
          break; 
        case 12:
          xs1 = -1.42158611091771; xs2 = 1.20585725803955;
          ds = 0.678821948823342; bs = -0.1943685; cs = 0.838441029448401;
          break; 
        case 13:
          xs1 = -1.43505147140695; xs2 = 1.22563249486353;
          ds = 0.686012147338669; bs = -0.1970756; cs = 0.870507303464709;
          break;
        }
        
        break; 
        
        // :::: case c = 11
      case 11:
        
        switch(rs) {
        case 1:
          xs1 = -1.30218578553199; xs2 = 1.07371507497539;
          ds = 0.61550486921697; bs = -0.1549362; cs = 0.535127988250555;
          break; 
        case 2:
          xs1 = -1.30763955986219; xs2 = 1.079017668812;
          ds = 0.618144289258018; bs = -0.1566505; cs = 0.548465855363621;
          break; 
        case 3:
          xs1 = -1.31311713552846; xs2 = 1.08446779709585;
          ds = 0.620813581398505; bs = -0.1583429; cs = 0.561898249208704;
          break; 
        case 4:
          xs1 = -1.3186147537383; xs2 = 1.09006274859511;
          ds = 0.623510536866224; bs = -0.1600116; cs = 0.575411077354775;
          break; 
        case 5:
          xs1 = -1.32412871669778; xs2 = 1.09579947132622;
          ds = 0.626232904589765; bs = -0.1616553; cs = 0.588990103959572;
          break; 
        case 6:
          xs1 = -1.32965540218628; xs2 = 1.1016745919574;
          ds = 0.633134283267187; bs = -0.1644482; cs = 0.623134198274007;
          break; 
        case 7:
          xs1 = -1.34350483622778; xs2 = 1.11694310353815;
          ds = 0.640145193903421; bs = -0.1683091; cs = 0.657380326131252;
          break; 
        case 8:
          xs1 = -1.35735968720137; xs2 = 1.13298843404641;
          ds = 0.647228935737372; bs = -0.1719746; cs = 0.69151575270864;
          break; 
        case 9:
          xs1 = -1.3711723666068; xs2 = 1.14973779971855;
          ds = 0.654351143019727; bs = -0.1754328; cs = 0.725340573428878;
          break; 
        case 10:
          xs1 = -1.3849004642748; xs2 = 1.16711265300615;
          ds = 0.661479407935822; bs = -0.1786764; cs = 0.758673628655332;
          break;
        case 11:
          xs1 = -1.39850691879396; xs2 = 1.18503120279742;
          ds = 0.668583850207254; bs = -0.1817019; cs = 0.791355870506869;
          break; 
        case 12:
          xs1 = -1.41195993621311; xs2 = 1.20341073730133;
          ds = 0.675637499127384; bs = -0.1845097; cs = 0.823252261264231;
          break; 
        case 13:
          xs1 = -1.42523273728888; xs2 = 1.22216965422062;
          ds = 0.682616503387763; bs = -0.1871032; cs = 0.854252339648034;
          break;
        }
        
        break; 
        
        // :::: case c = 12
      case 12:
        
        switch(rs) {
        case 1:
          xs1 = -1.29655400239786; xs2 = 1.07769724127067;
          ds = 0.614846231814851; bs = -0.1482245; cs = 0.53345390016894;
          break; 
        case 2:
          xs1 = -1.3018090207266; xs2 = 1.08278264773578;
          ds = 0.617379637956879; bs = -0.1498084; cs = 0.546209140986275;
          break; 
        case 3:
          xs1 = -1.30709095293555; xs2 = 1.08800338574245;
          ds = 0.61994179062688; bs = -0.1513736; cs = 0.559052955268662;
          break; 
        case 4:
          xs1 = -1.31239645237498; xs2 = 1.09335712573181;
          ds = 0.622530747176358; bs = -0.1529186; cs = 0.571972944846775;
          break; 
        case 5:
          xs1 = -1.31772220478147; xs2 = 1.09884124595676;
          ds = 0.625144522232608; bs = -0.1544421; cs = 0.584956575291965;
          break; 
        case 6:
          xs1 = -1.32306494106128; xs2 = 1.10445284760196;
          ds = 0.631774239755372; bs = -0.1570366; cs = 0.617611357270377;
          break; 
        case 7:
          xs1 = -1.33647517470145; xs2 = 1.11901826064148;
          ds = 0.638513862123763; bs = -0.1606319; cs = 0.650389793409301;
          break; 
        case 8:
          xs1 = -1.34992350738526; xs2 = 1.13430445329826;
          ds = 0.645332651447122; bs = -0.1640586; cs = 0.683100383127441;
          break; 
        case 9:
          xs1 = -1.36336521671148; xs2 = 1.15024838148343;
          ds = 0.652198573312452; bs = -0.1673055; cs = 0.715564547663896;
          break; 
        case 10:
          xs1 = -1.37675957973645; xs2 = 1.16678161303605;
          ds = 0.65908187466561; bs = -0.1703649; cs = 0.747617951846068;
          break;
        case 11:
          xs1 = -1.3900701755076; xs2 = 1.1838324034109;
          ds = 0.665954778187898; bs = -0.1732328; cs = 0.779114389557054;
          break; 
        case 12:
          xs1 = -1.40326498463112; xs2 = 1.20132765572296;
          ds = 0.672791868644762; bs = -0.1759083; cs = 0.809927678103837;
          break; 
        case 13:
          xs1 = -1.41631631350419; xs2 = 1.21919466719253;
          ds = 0.679570338112568; bs = -0.1783929; cs = 0.839952460418583;
          break;
        }
        
        break; 
        
        // :::: case c = 13
      case 13:
        
        switch(rs) {
        case 1:
          xs1 = -1.2915981842013; xs2 = 1.08124133774245;
          ds = 0.614280857442137; bs = -0.1423113; cs = 0.532018600578787;
          break; 
        case 2:
          xs1 = -1.29667248693713; xs2 = 1.08613471579496;
          ds = 0.616719621413504; bs = -0.143783; cs = 0.544260958976816;
          break; 
        case 3:
          xs1 = -1.30177573916986; xs2 = 1.09115302412109;
          ds = 0.619186005483656; bs = -0.1452385; cs = 0.556586622378575;
          break; 
        case 4:
          xs1 = -1.30690494629931; xs2 = 1.09629423475761;
          ds = 0.621678286533378; bs = -0.1466766; cs = 0.568984575157478;
          break; 
        case 5:
          xs1 = -1.31205712692476; xs2 = 1.10155606672045;
          ds = 0.624194699655974; bs = -0.1480961; cs = 0.581443673698991;
          break; 
        case 6:
          xs1 = -1.31722932397012; xs2 = 1.10693599800616;
          ds = 0.630579445557768; bs = -0.1505179; cs = 0.61278528080499;
          break; 
        case 7:
          xs1 = -1.33022832186435; xs2 = 1.12088394609812;
          ds = 0.637074411467038; bs = -0.1538811; cs = 0.644264781403385;
          break; 
        case 8:
          xs1 = -1.3432900044754; xs2 = 1.13550378810041;
          ds = 0.643652227655258; bs = -0.157097; cs = 0.675710045277714;
          break; 
        case 9:
          xs1 = -1.35637259658866; xs2 = 1.15074035403159;
          ds = 0.650283511002962; bs = -0.1601554; cs = 0.706959975988786;
          break; 
        case 10:
          xs1 = -1.3694373985027; xs2 = 1.16653346727879;
          ds = 0.656940922704584; bs = -0.1630487; cs = 0.73786476521975;
          break;
        case 11:
          xs1 = -1.38244917968577; xs2 = 1.18281968564618;
          ds = 0.663598663067615; bs = -0.1657725; cs = 0.768289634880748;
          break; 
        case 12:
          xs1 = -1.39537636353549; xs2 = 1.19953395070595;
          ds = 0.67023285481111; bs = -0.1683249; cs = 0.798116659555752;
          break; 
        case 13:
          xs1 = -1.40819108227764; xs2 = 1.21661110270945;
          ds = 0.676821801762003; bs = -0.1707065; cs = 0.827245697135113;
          break;
        }
        
        break;
        
        // :::: case c = 14
      case 14:
        
        switch(rs) {
        case 1:
          xs1 = -1.28719503526118; xs2 = 1.08442294811688;
          ds = 0.613790016401842; bs = -0.1370503; cs = 0.530772838179015;
          break; 
        case 2:
          xs1 = -1.2921044700986; xs2 = 1.08914491060972;
          ds = 0.616143674747764; bs = -0.1384246; cs = 0.5425592165824;
          break; 
        case 3:
          xs1 = -1.29704414450084; xs2 = 1.09398283828851;
          ds = 0.618523856953269; bs = -0.1397847; cs = 0.554424210959892;
          break; 
        case 4:
          xs1 = -1.30201136511723; xs2 = 1.09893494597172;
          ds = 0.620929022990038; bs = -0.1411295; cs = 0.566357950909481;
          break; 
        case 5:
          xs1 = -1.3070034388409; xs2 = 1.10399922744204;
          ds = 0.623357592691891; bs = -0.142458; cs = 0.578350446532285;
          break; 
        case 6:
          xs1 = -1.31201768247087; xs2 = 1.10917346512741;
          ds = 0.629520755480261; bs = -0.1447284; cs = 0.608522635740797;
          break; 
        case 7:
          xs1 = -1.32463287172068; xs2 = 1.12257378824518;
          ds = 0.635794234751809; bs = -0.1478869; cs = 0.638841925133808;
          break; 
        case 8:
          xs1 = -1.33732933810762; xs2 = 1.13660303772199;
          ds = 0.642151330562894; bs = -0.1509158; cs = 0.669154761467935;
          break; 
        case 9:
          xs1 = -1.35006816432743; xs2 = 1.15121249476262;
          ds = 0.648567261102519; bs = -0.1538054; cs = 0.699312697255534;
          break; 
        case 10:
          xs1 = -1.36281281318413; xs2 = 1.16634881934345;
          ds = 0.655016094711153; bs = -0.1565485; cs = 0.729179314238778;
          break;
        case 11:
          xs1 = -1.37552950860469; xs2 = 1.18195548959828;
          ds = 0.66147386652773; bs = -0.1591405; cs = 0.75863000138075;
          break; 
        case 12:
          xs1 = -1.38818752527109; xs2 = 1.19797423381619;
          ds = 0.667918175578686; bs = -0.1615789; cs = 0.787554454214553;
          break; 
        case 13:
          xs1 = -1.40075929993442; xs2 = 1.21434633183012;
          ds = 0.674328448571189; bs = -0.1638634; cs = 0.815857660902587;
          break;
        }
        
        break; 
      }
      
      const double ts = std::sqrt(2.0) * a;
      const double t = -b / ts;
      const double d1 = pbdv(-c-1, t);
      const double d21 = pbdv(-c-2, t) / d1;
      const double d31 = (1.0 - t * d21);
      
      const double mu = ((double)c + 1.0) * d21 / ts;
      // const double s2 = ((double)c + 1.0) * ((double)c + 2.0) * d31 / (ts * ts) - mu * mu; 
      const double s2 = ((double)c + 1.0) * d31 / (ts * ts) - mu * mu; 
      
      const double s = std::sqrt(s2);
      const double w = 1.0 / (ts * s);
      
      double u = R::rnorm(0.0, w);
      double kf = 0.0, kg = 0.0, q = 0.0;
      
      out = u * s + mu;
      
      if ((xs1 <= u) && (u <= xs2)) 
      {  
        // :::::::::::: 
        // STEP 1
        
        return out;
      } 
      else 
      {
        // :::::::::::: 
        // STEP 2
        
        kf = s * std::pow(ts, c + 1) / (std::exp(0.25 * t * t) * d1 * factorial(c));
        kg = w * s2pi;
        
        if (u > -mu/s) 
        {
          q = kf * kg * std::pow(out, c) * std::exp(out * (b - ts * ts * mu) + a * a * mu * mu);
          if (R::runif(0, 1) <= q) 
            return out;
        }
      }
      
      // :::::::::::: 
      // STEP 3
      
      int i = 0;
      double e, x, f, g, dlap;
      
      while (i < 1e+16) 
      {
        i += 1;
        e = R::rexp(1);
        u = R::runif(0, 1);
        u = u + u - 1.0;
        
        if (u < 0.0) 
        {
          x = bs - ds * e;
        } 
        else 
        {
          x = bs + ds * e;
        }
        out = x * s + mu;
        
        if ((xs1 <= x) && (x <= xs2)) 
        {
          f = kf * std::pow(out, c) * std::exp(-a * a * out * out + b * out);
          g = std::exp(-0.5 * x * x / (w * w)) / kg;
          dlap = cs / s2pi * std::exp(-std::abs(x - bs) / ds);
          
          if (std::abs(u) <= ((f - g) / dlap)) 
            return out;
        }
      }
    }
  } 
  else 
  {
    // :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    // case b > 0: Normal approximation
    
    if (r >= 30) 
    {
      // approximated parameters
      const double q = 2.0 * a * a;
      const double mu = b / q;
      const double s2 = 1.0 / q;
      
      out = R::rnorm(mu, sqrt(s2));
      while (out <= 0.0) 
        out = R::rnorm(mu, sqrt(s2));  
      
      return out;
    } 
    else if (r >= 5) 
    {
      // const double ts = sqrt(2.0) * a;
      // const double t = -b / ts;
      // 
      // const double u = -t;
      // const double q = u + 0.5 * (t + std::sqrt(t * t + 4.0 * c + 2.0));
      // const double w = u + 0.5 * (t + std::sqrt(t * t + 4.0 * c + 6.0));
      // const double mu = q / ts;
      // const double s2 = q * (w - q) / (ts * ts);

      const double ts = std::sqrt(2.0) * a;
      const double t = -b / ts;
      const double d1 = pbdv(-c-1, t);
      const double d21 = pbdv(-c-2, t) / d1;
      const double d31 = (1.0 - t * d21);
      
      const double mu = ((double)c + 1.0) * d21 / ts;
      const double s2 = ((double)c + 1.0) * d31 / (ts * ts) - mu * mu; 
      
      out = R::rnorm(mu, sqrt(s2));
      while (out <= 0.0) 
        out = R::rnorm(mu, sqrt(s2));  
      
      return out;
    }
    else 
    {
      // Exact sampling
      double xs1 = 0.0, xs2 = 0.0, ds = 0.0, bs = 0.0, cs = 0.0;
      
      switch(c) 
      {
      // :::: case c = 1
      case 1:
        
        switch(rs) {
        case 1:
          xs1 = -1.53406499365263; xs2 = 0.897099868956042;
          ds = 0.651316106787244; bs = -0.4893424; cs = 0.645683883557984;
          break; 
        case 2:
          xs1 = -1.53677503595901; xs2 = 0.882441053489848;
          ds = 0.647118639185317; bs = -0.481464; cs = 0.601625204378373;
          break; 
        case 3:
          xs1 = -1.53844474387079; xs2 = 0.868805896139059;
          ds = 0.642737657643309; bs = -0.4728009; cs = 0.558275397563083;
          break; 
        case 4:
          xs1 = -1.5378220009327; xs2 = 0.856285253741137;
          ds = 0.638159318660735; bs = -0.4633445; cs = 0.515946250181509;
          break; 
        case 5:
          xs1 = -1.53511863220306; xs2 = 0.84496488884044;
          ds = 0.633375865516132; bs = -0.4530994; cs = 0.474938553341791;
          break; 
        case 6:
          xs1 = -1.52003476398805; xs2 = 0.822392749748821;
          ds = 0.628387467204558; bs = -0.432877; cs = 0.435531694260361;
          break; 
        case 7:
          xs1 = -1.49217848955996; xs2 = 0.808571949747569;
          ds = 0.615108869353087; bs = -0.4011468; cs = 0.345547749251269;
          break; 
        case 8:
          xs1 = -1.45284887462643; xs2 = 0.803454556472932;
          ds = 0.601074984418797; bs = -0.3663053; cs = 0.26968974729252;
          break; 
        case 9:
          xs1 = -1.4061695417862; xs2 = 0.803454556472932;
          ds = 0.587071622998585; bs = -0.3300687; cs = 0.208720977879743;
          break; 
        case 10:
          xs1 = -1.35770976619668; xs2 = 0.80591579713146;
          ds = 0.574019376896896; bs = -0.2944748; cs = 0.161643333219136;
          break; 
        case 11:
          xs1 = -1.31238194093465; xs2 = 0.813896651189013;
          ds = 0.562675775766095; bs = -0.2614344; cs = 0.12630407612564;
          break; 
        case 12:
          xs1 = -1.27303663426414; xs2 = 0.824969842044926;
          ds = 0.553414886421639; bs = -0.2322547; cs = 0.100143330261176;
          break; 
        case 13:
          xs1 = -1.24039674144834; xs2 = 0.83703314448015;
          ds = 0.546199377716538; bs = -0.2074166; cs = 0.080779310328355;
          break;
        }
        
        break; 
        
        // :::: case c = 2
      case 2:
        
        switch(rs) {
        case 1:
          xs1 = -1.46178987528411; xs2 = 0.955394743257614;
          ds = 0.636240719346582; bs = -0.3590195; cs = 0.58101878942103;
          break; 
        case 2:
          xs1 = -1.45535236244794; xs2 = 0.944687473787243;
          ds = 0.631586201517459; bs = -0.3525467; cs = 0.549635257936028;
          break; 
        case 3:
          xs1 = -1.44828879160536; xs2 = 0.934696005969917;
          ds = 0.626896448877901; bs = -0.3457342; cs = 0.518800023127736;
          break; 
        case 4:
          xs1 = -1.44058381300014; xs2 = 0.925452258702332;
          ds = 0.622182869133567; bs = -0.3385981; cs = 0.48865170404896;
          break; 
        case 5:
          xs1 = -1.43223416632436; xs2 = 0.916982163095305;
          ds = 0.61745908303214; bs = -0.3311596; cs = 0.459321542755224;
          break; 
        case 6:
          xs1 = -1.40864565924212; xs2 = 0.899296017610093;
          ds = 0.612740844448353; bs = -0.3173535; cs = 0.430930329612771;
          break; 
        case 7:
          xs1 = -1.38171283329539; xs2 = 0.886606440787461;
          ds = 0.601089288909337; bs = -0.2967998; cs = 0.364727190140832;
          break; 
        case 8:
          xs1 = -1.35255754372486; xs2 = 0.878624903904119;
          ds = 0.589897868961879; bs = -0.2755445; cs = 0.306243280501806;
          break; 
        case 9:
          xs1 = -1.32263685639215; xs2 = 0.874735802686108;
          ds = 0.579483120468177; bs = -0.2543007; cs = 0.255988350962901;
          break; 
        case 10:
          xs1 = -1.29341423095496; xs2 = 0.874103650527289;
          ds = 0.570108302495764; bs = -0.2337583; cs = 0.213794657351729;
          break; 
        case 11:
          xs1 = -1.26605487067441; xs2 = 0.874103650527289;
          ds = 0.561931952571541; bs = -0.2144812; cs = 0.178982150621234;
          break; 
        case 12:
          xs1 = -1.24126692374747; xs2 = 0.875827607845636;
          ds = 0.554989467942161; bs = -0.1968403; cs = 0.150579752297377;
          break; 
        case 13:
          xs1 = -1.21931264802887; xs2 = 0.879085708595989;
          ds = 0.549216701987304; bs = -0.1809982; cs = 0.127527991271442;
          break;
        }
        
        break; 
        
        // :::: case c = 3
      case 3:
        
        switch(rs) {
        case 1:
          xs1 = -1.41323953288927; xs2 = 0.98754771526208;
          ds = 0.628250353270676; bs = -0.2946635; cs = 0.557250144441363;
          break; 
        case 2:
          xs1 = -1.40562736834635; xs2 = 0.97863715125256;
          ds = 0.623935109589129; bs = -0.2895454; cs = 0.531749313757903;
          break; 
        case 3:
          xs1 = -1.39772660610707; xs2 = 0.970251752845765;
          ds = 0.619639719219822; bs = -0.284249; cs = 0.506668938075125;
          break; 
        case 4:
          xs1 = -1.38954804649804; xs2 = 0.962406007362489;
          ds = 0.61537471614394; bs = -0.2787879; cs = 0.482090078233182;
          break; 
        case 5:
          xs1 = -1.3811076372962; xs2 = 0.955110565445415;
          ds = 0.611151202703462; bs = -0.273178; cs = 0.458089211623088;
          break; 
        case 6:
          xs1 = -1.35901249337416; xs2 = 0.939311115848679;
          ds = 0.606980687311777; bs = -0.2629941; cs = 0.4347369051742;
          break; 
        case 7:
          xs1 = -1.33588924475621; xs2 = 0.926957412313699;
          ds = 0.596864923164522; bs = -0.2480949; cs = 0.379588836113274;
          break; 
        case 8:
          xs1 = -1.31234445132885; xs2 = 0.9178529709287549;
          ds = 0.587333475789242; bs = -0.2329545; cs = 0.329624497924211;
          break; 
        case 9:
          xs1 = -1.28904000220198; xs2 = 0.911651087373486;
          ds = 0.578543285074345; bs = -0.2179332; cs = 0.285236491101654;
          break; 
        case 10:
          xs1 = -1.26658982265379; xs2 = 0.907904179107595;
          ds = 0.570606859032484; bs = -0.2033632; cs = 0.24646338223707;
          break; 
        case 11:
          xs1 = -1.24547599570675; xs2 = 0.90612509904825;
          ds = 0.563580210785024; bs = -0.189515; cs = 0.213050671832602;
          break; 
        case 12:
          xs1 = -1.226007093177; xs2 = 0.905843892550207;
          ds = 0.557461640173338; bs = -0.1765769; cs = 0.184541784225583;
          break; 
        case 13:
          xs1 =-1.2083211263688; xs2 = 0.905843892550207;
          ds = 0.55220495007985; bs = -0.164652; cs = 0.160371262775221;
          break;
        }
        
        break; 
        
        // :::: case c = 4
      case 4:
        
        switch(rs) {
        case 1:
          xs1 = -1.38146998714414; xs2 = 1.00854765667496;
          ds = 0.623497545897408; bs = -0.2552536; cs = 0.54512307388183;
          break; 
        case 2:
          xs1 = -1.373927223454; xs2 = 1.00071054189895;
          ds = 0.619550882367871; bs = -0.2510834; cs = 0.523134238495529;
          break; 
        case 3:
          xs1 = -1.36624939688676; xs2 = 0.993282706530516;
          ds = 0.615642821174167; bs = -0.2468055; cs = 0.501481797176213;
          break; 
        case 4:
          xs1 = -1.35844931764152; xs2 = 0.986272162948483;
          ds = 0.611781408367917; bs = -0.24243; cs = 0.480220192842663;
          break; 
        case 5:
          xs1 = -1.35054207426244; xs2 = 0.97968442378057;
          ds = 0.607975736269917; bs = -0.2379679; cs = 0.459400091483328;
          break; 
        case 6:
          xs1 = -1.33042313097364; xs2 = 0.965077084302118;
          ds = 0.604232369310985; bs = -0.2299531; cs = 0.439070338995095;
          break; 
        case 7:
          xs1 = -1.31006517856121; xs2 = 0.953093661715316;
          ds = 0.595200846218568; bs = -0.2183175; cs = 0.390660912522901;
          break; 
        case 8:
          xs1 = -1.28983017873373; xs2 = 0.943602698982664;
          ds = 0.586725806096556; bs = -0.2065744; cs = 0.346105218487411;
          break; 
        case 9:
          xs1 = -1.27008327267517; xs2 = 0.936385817253664;
          ds = 0.578899246946919; bs = -0.1949375; cs = 0.30572084705359;
          break; 
        case 10:
          xs1 = -1.2511507873389; xs2 = 0.931163686127737;
          ds = 0.571782475660662; bs = -0.1836018; cs = 0.269608187216169;
          break;
        case 11:
          xs1 = -1.23328808521846; xs2 = 0.92762693855592;
          ds = 0.565402043996812; bs = -0.1727288; cs = 0.237677636937213;
          break; 
        case 12:
          xs1 = -1.21666373715392; xs2 = 0.92546550207536;
          ds = 0.559750823173973; bs = -0.1624375; cs = 0.209694225204257;
          break; 
        case 13:
          xs1 = -1.20136038752652; xs2 = 0.924391319410006;
          ds = 0.554795835587942; bs = -0.1528025; cs = 0.185327308074482;
          break;
        }
        
        break; 
        
        // :::: case c = 5
      case 5:
        
        switch(rs) {
        case 1:
          xs1 = -1.35910383065659; xs2 = 1.02364931928401;
          ds = 0.620383025538082; bs = -0.2281396; cs = 0.537813868028887;
          break; 
        case 2:
          xs1 = -1.35189584074372; xs2 = 1.01654998228287;
          ds = 0.616750713929037; bs = -0.2246395; cs = 0.518209232431923;
          break; 
        case 3:
          xs1 = -1.34462892744261; xs2 = 1.00978397753468;
          ds = 0.613162403819691; bs = -0.2210679; cs = 0.498883875467298;
          break; 
        case 4:
          xs1 = -1.33731420706589; xs2 = 1.00335638090428;
          ds = 0.609624743826199; bs = -0.217432; cs = 0.479877078062333;
          break; 
        case 5:
          xs1 = -1.32996386863151; xs2 = 0.997270546358819;
          ds = 0.60614379793143; bs = -0.2137398; cs = 0.461226417675822;
          break; 
        case 6:
          xs1 = -1.31152045936733; xs2 = 0.983557051619166;
          ds = 0.60272546758506; bs = -0.2071471; cs = 0.442966919135885;
          break; 
        case 7:
          xs1 = -1.29316296358343; xs2 = 0.971959903778906;
          ds = 0.594490008092161; bs = -0.1976149; cs = 0.399232082256059;
          break; 
        case 8:
          xs1 = -1.27512833022868; xs2 = 0.962387536657174;
          ds = 0.586759334437655; bs = -0.188025; cs = 0.358541703499574;
          break; 
        case 9:
          xs1 = -1.25764491520933; xs2 = 0.954691158353205;
          ds = 0.579594427686882; bs = -0.1785182; cs = 0.321159672078689;
          break; 
        case 10:
          xs1 = -1.24091220684457; xs2 = 0.948680041921338;
          ds = 0.573034239656161; bs = -0.1692231; cs = 0.287203571763945;
          break;
        case 11:
          xs1 = -1.2250858392101; xs2 = 0.944139488151574;
          ds = 0.567094191919647; bs = -0.1602483; cs = 0.25665801527484;
          break; 
        case 12:
          xs1 = -1.21027026055313; xs2 = 0.940848318979488;
          ds = 0.56176739600547; bs = -0.1516775; cs = 0.229399057891512;
          break; 
        case 13:
          xs1 = -1.19651910949009; xs2 = 0.938593379069223;
          ds = 0.557029681361969; bs = -0.1435679; cs = 0.2052233021482;
          break;
        }
        
        break; 
        
        // :::: case c = 6
      case 6:
        
        switch(rs) {
        case 1:
          xs1 = -1.34241712407192; xs2 = 1.03519502517879;
          ds = 0.618195955681567; bs = -0.2080799; cs = 0.532939442470602;
          break; 
        case 2:
          xs1 = -1.33558283600024; xs2 = 1.02864574670413;
          ds = 0.614822238220185; bs = -0.2050716; cs = 0.515085966334384;
          break; 
        case 3:
          xs1 = -1.32873048667216; xs2 = 1.02237670138512;
          ds = 0.611493894326137; bs = -0.2020123; cs = 0.497470029045212;
          break; 
        case 4:
          xs1 = -1.32186923579792; xs2 = 1.01639142447983;
          ds = 0.608215726633726; bs = -0.1989075; cs = 0.48012223375403;
          break; 
        case 5:
          xs1 = -1.31500876505605; xs2 = 1.01069220430353;
          ds = 0.604992400026152; bs = -0.1957632; cs = 0.463071614772915;
          break; 
        case 6:
          xs1 = -1.29792820179181; xs2 = 0.997699139189188;
          ds = 0.60182839477592; bs = -0.1901693; cs = 0.446345361422824;
          break; 
        case 7:
          xs1 = -1.28108161029699; xs2 = 0.98647775077087;
          ds = 0.594205114895596; bs = -0.1821007; cs = 0.406107820055916;
          break; 
        case 8:
          xs1 = -1.26463536036467; xs2 = 0.9769617291641;
          ds = 0.587036487278627; bs = -0.1739962; cs = 0.368374077362914;
          break; 
        case 9:
          xs1 = -1.24874499883275; xs2 = 0.969043966723079;
          ds = 0.580366396653033; bs = -0.1659555; cs = 0.333368001149064;
          break; 
        case 10:
          xs1 = -1.23354422238781; xs2 = 0.962586322320671;
          ds = 0.574222285010165; bs = -0.1580702; cs = 0.301208478348337;
          break;
        case 11:
          xs1 = -1.21913693789011; xs2 = 0.957431061205528;
          ds = 0.568614564811848; bs = -0.1504188; cs = 0.27191632212649;
          break; 
        case 12:
          xs1 = -1.2055934290464; xs2 = 0.953412251406753;
          ds = 0.563537643941025; bs = -0.1430639; cs = 0.245428648210631;
          break; 
        case 13:
          xs1 = -1.19295061715822; xs2 = 0.950365680299655;
          ds = 0.558972150075646; bs = -0.136051; cs = 0.221617549109899;
          break;
        }
        
        break; 
        
        // :::: case c = 7
      case 7:
        
        switch(rs) {
        case 1:
          xs1 = -1.32941589909958; xs2 = 1.04440196989372;
          ds = 0.616579059707605; bs = -0.1924877; cs = 0.529461847147369;
          break; 
        case 2:
          xs1 = -1.32293522293036; xs2 = 1.03828482743874;
          ds = 0.613420453948076; bs = -0.1898533; cs = 0.512962535479381;
          break; 
        case 3:
          xs1 = -1.31645971978541; xs2 = 1.03240889618958;
          ds = 0.610306119159213; bs = -0.1871806; cs = 0.496669821669387;
          break; 
        case 4:
          xs1 = -1.30999691195508; xs2 = 1.02677681150626;
          ds = 0.607239898444707; bs = -0.1844739; cs = 0.480608223981231;
          break; 
        case 5:
          xs1 = -1.30355457295997; xs2 = 1.02139026847294;
          ds = 0.604225491294327; bs = -0.1817378; cs = 0.464801061123547;
          break; 
        case 6:
          xs1 = -1.28759079891909; xs2 = 1.0090006545744;
          ds = 0.601266421342504; bs = -0.1768823; cs = 0.449270260037989;
          break; 
        case 7:
          xs1 = -1.27193112419623; xs2 = 0.998133319539487;
          ds = 0.594132027135969; bs = -0.1698893; cs = 0.411781723609768;
          break; 
        case 8:
          xs1 = -1.25669868856189; xs2 = 0.988738688890459;
          ds = 0.587408443900162; bs = -0.1628712; cs = 0.376412021852618;
          break; 
        case 9:
          xs1 = -1.24200614263083; xs2 = 0.98073650400904;
          ds = 0.581129154668107; bs = -0.1559024; cs = 0.343354241329663;
          break; 
        case 10:
          xs1 = -1.22794910735243; xs2 = 0.974022441763447;
          ds = 0.575314937963965; bs = -0.1490515; cs = 0.312722642119919;
          break;
        case 11:
          xs1 = -1.21460157201152; xs2 = 0.968475881738699;
          ds = 0.569973643828723; bs = -0.1423782; cs = 0.284556310944581;
          break; 
        case 12:
          xs1 = -1.20201372185187; xs2 = 0.963967792635426;
          ds = 0.565101005507068; bs = -0.1359314; cs = 0.258828077450471;
          break; 
        case 13:
          xs1 = -1.19021216919287; xs2 = 0.960367848346881;
          ds = 0.560682227197399; bs = -0.1297482; cs = 0.235456813683591;
          break;
        }
        
        break; 
        
        // :::: case c = 8
      case 8:
        
        switch(rs) {
        case 1:
          xs1 = -1.31894729888092; xs2 = 1.05197283620668;
          ds = 0.615337018792941; bs = -0.1799278; cs = 0.526857446121175;
          break; 
        case 2:
          xs1 = -1.31278630671183; xs2 = 1.04620773855379;
          ds = 0.612359371352868; bs = -0.1775862; cs = 0.511445322640678;
          break; 
        case 3:
          xs1 = -1.30664422201972; xs2 = 1.04065405095889;
          ds = 0.60942412478821; bs = -0.1752147; cs = 0.496215829554585;
          break; 
        case 4:
          xs1 = -1.30052728079505; xs2 = 1.03531383855865;
          ds = 0.606534425848665; bs = -0.1728169; cs = 0.481189183726589;
          break; 
        case 5:
          xs1 = -1.29444182954427; xs2 = 1.03018843414478;
          ds = 0.603693285643276; bs = -0.1703963; cs = 0.46638465695166;
          break; 
        case 6:
          xs1 = -1.2794080611967; xs2 = 1.01831677173769;
          ds = 0.600903556676715; bs = -0.166108; cs = 0.451820435808459;
          break; 
        case 7:
          xs1 = -1.26471069079369; xs2 = 1.00777855668776;
          ds = 0.59417119813784; bs = -0.1599383; cs = 0.416569344004919;
          break; 
        case 8:
          xs1 = -1.25044462793097; xs2 = 0.998535767579449;
          ds = 0.587812248900596; bs = -0.1537495; cs = 0.383149987601263;
          break; 
        case 9:
          xs1 = -1.2366952861027; xs2 = 0.990526403112591;
          ds = 0.581853376064891; bs = -0.1475992; cs = 0.351731180750971;
          break; 
        case 10:
          xs1 = -1.22353444023433; xs2 = 0.98366917890657;
          ds = 0.576311146998583; bs = -0.1415407; cs = 0.322420486839547;
          break;
        case 11:
          xs1 = -1.21101737553571; xs2 = 0.977869056418861;
          ds = 0.571191958421409; bs = -0.1356211; cs = 0.295266118191264;
          break; 
        case 12:
          xs1 = -1.19918158453812; xs2 = 0.973022947159;
          ds = 0.566492673173708; bs = -0.1298797; cs = 0.270262676772747;
          break; 
        case 13:
          xs1 = -1.18804698514284; xs2 = 0.969025007275626;
          ds = 0.562201792592252; bs = -0.1243476; cs = 0.247359561166914;
          break;
        }
        
        break; 
        
        // :::: case c = 9
      case 9:
        
        switch(rs) {
        case 1:
          xs1 = -1.31029950435497; xs2 = 1.05834543430175;
          ds = 0.614353837562868; bs = -0.1695343; cs = 0.524834796512638;
          break; 
        case 2:
          xs1 = -1.30442374888214; xs2 = 1.05287487383769;
          ds = 0.611530555250423; bs = -0.1674278; cs = 0.510320208496431;
          break; 
        case 3:
          xs1 = -1.29857520204276; xs2 = 1.0475922651915;
          ds = 0.608747560182182; bs = -0.1652974; cs = 0.495969172229615;
          break; 
        case 4:
          xs1 = -1.29275909898831; xs2 = 1.04249928857005;
          ds = 0.606007480400261; bs = -0.1631458; cs = 0.481798731848453;
          break; 
        case 5:
          xs1 = -1.28698070937746; xs2 = 1.03759703868596;
          ds = 0.603312820464651; bs = -0.1609759; cs = 0.467825168682199;
          break; 
        case 6:
          xs1 = -1.27273421155143; xs2 = 1.02617770355089;
          ds = 0.600665944582662; bs = -0.1571369; cs = 0.454063895318885;
          break; 
        case 7:
          xs1 = -1.25883681747726; xs2 = 1.01594389816796;
          ds = 0.594271878841987; bs = -0.1516175; cs = 0.420681696318118;
          break; 
        case 8:
          xs1 = -1.24536404241581; xs2 = 1.00686585614789;
          ds = 0.588219400104772; bs = -0.1460825; cs = 0.388909448744495;
          break; 
        case 9:
          xs1 = -1.23238298601329; xs2 = 0.998894521724485;
          ds = 0.582530446132244; bs = -0.1405778; cs = 0.358896427985428;
          break; 
        case 10:
          xs1 = -1.21994957035621; xs2 = 0.991965003492729;
          ds =  0.577218736396843; bs = -0.1351462; cs = 0.330743021908871;
          break;
        case 11:
          xs1 = -1.20810668038879; xs2 = 0.986000656011602;
          ds = 0.572289767303904; bs = -0.1298258; cs = 0.304501643426755;
          break; 
        case 12:
          xs1 = -1.19688334941095; xs2 = 0.980917348315831;
          ds = 0.567741313816074; bs = -0.1246491; cs = 0.28018052777791;
          break; 
        case 13:
          xs1 = -1.18629496489779; xs2 = 0.976627516812861;
          ds = 0.563564319371103; bs = -0.1196422; cs = 0.25774964872088;
          break;
        }
        
        break; 
        
        // :::: case c = 10
      case 10:
        
        switch(rs) {
        case 1:
          xs1 = -1.30300880613276; xs2 = 1.063808754775;
          ds = 0.613556651541754; bs = -0.1607508; cs = 0.523218923277303;
          break; 
        case 2:
          xs1 = -1.29738712431708; xs2 = 1.05858968953838;
          ds = 0.610866764297257; bs = -0.1588371; cs = 0.509461513461827;
          break; 
        case 3:
          xs1 = -1.29179769670958; xs2 = 1.05353965649626;
          ds = 0.608215039236976; bs = -0.1569037; cs = 0.495852125987539;
          break; 
        case 4:
          xs1 = -1.28624497455574; xs2 = 1.04866006261741;
          ds = 0.605603708429559; bs = -0.1549528; cs = 0.482405385582023;
          break; 
        case 5:
          xs1 = -1.2807334016414; xs2 = 1.04395183665524;
          ds = 0.603034893139057; bs = -0.1529869; cs = 0.469135288912419;
          break; 
        case 6:
          xs1 = -1.26716327790066; xs2 = 1.03293276345797;
          ds = 0.600510591083274; bs = -0.1495122; cs = 0.456055122187394;
          break; 
        case 7:
          xs1 = -1.2539443905603; xs2 = 1.0229802457925;
          ds = 0.594406442389516; bs = -0.1445194; cs = 0.424265576670649;
          break; 
        case 8:
          xs1 = -1.24113837550646; xs2 = 1.01407058743643;
          ds = 0.588616677372017; bs = -0.1395131; cs = 0.393909850109186;
          break; 
        case 9:
          xs1 = -1.2287994495855; xs2 = 1.00616422185285;
          ds = 0.583159800709775; bs = -0.134531; cs = 0.365121213421394;
          break; 
        case 10:
          xs1 = -1.21697249146511; xs2 = 0.999208325980775;
          ds = 0.578047500046511; bs = -0.1296081; cs = 0.337993066064338;
          break;
        case 11:
          xs1 = -1.20569177807769; xs2 = 0.993139921996699;
          ds = 0.573284668962936; bs = -0.1247759; cs = 0.312579276500676;
          break; 
        case 12:
          xs1 = -1.19498045963504; xs2 = 0.987889159105873;
          ds = 0.568869805940978; bs = -0.1200617; cs = 0.288896741378706;
          break; 
        case 13:
          xs1 = -1.18485075162228; xs2 = 0.983382488269605;
          ds = 0.564795704756253; bs = -0.115488; cs = 0.266929647292641;
          break;
        }
        
        break; 
        
        // :::: case c = 11
      case 11:
        
        switch(rs) {
        case 1:
          xs1 = -1.29675961629346; xs2 = 1.06856236900083;
          ds = 0.612897475936004; bs = -0.1532017; cs = 0.521898516614345;
          break; 
        case 2:
          xs1 = -1.29136488349463; xs2 = 1.0635615320418;
          ds = 0.610324198237242; bs = -0.1514488; cs = 0.508791006079241;
          break; 
        case 3:
          xs1 = -1.28600542753379; xs2 = 1.05871416141525;
          ds = 0.607787047617504; bs = -0.1496793; cs = 0.49581864162383;
          break; 
        case 4:
          xs1 = -1.28068507834611; xs2 = 1.05402146210183;
          ds = 0.605287947156396; bs = -0.1478952; cs = 0.482994153025589;
          break; 
        case 5:
          xs1 = -1.27540763515242; xs2 = 1.04948424147951;
          ds = 0.602828720971914; bs = -0.1460984; cs = 0.470329744298162;
          break; 
        case 6:
          xs1 = -1.26242615252532; xs2 = 1.03882310717708;
          ds = 0.600411084377408; bs = -0.1429252; cs = 0.457837028077164;
          break; 
        case 7:
          xs1 = -1.2497922156583; xs2 = 1.02913078514939;
          ds = 0.594559119486606; bs = -0.1383673; cs = 0.427426581997724;
          break; 
        case 8:
          xs1 = -1.23755719025546; xs2 = 1.02038815129486;
          ds = 0.588998115183436; bs = -0.1337975; cs = 0.398306921636913;
          break; 
        case 9:
          xs1 = -1.22576589420484; xs2 = 1.01256278518562;
          ds = 0.58374399189045; bs = -0.1292471; cs = 0.370598011809335;
          break; 
        case 10:
          xs1 = -1.21445521802699; xs2 = 1.00561099555374;
          ds = 0.578806923991714; bs = -0.1247453; cs = 0.344386715955656;
          break;
        case 11:
          xs1 = -1.20365323708861; xs2 = 0.999480233862084;
          ds = 0.574191373008932; bs = -0.1203188; cs = 0.319726799726882;
          break; 
        case 12:
          xs1 = -1.19337886552231; xs2 = 0.99411167392159;
          ds = 0.569896408156941; bs = -0.1159907; cs = 0.296640675836787;
          break; 
        case 13:
          xs1 = -1.18364203333609; xs2 = 0.989442746759741;
          ds = 0.565916252574446; bs = -0.1117804; cs = 0.275122532117725;
          break;
        }
        
        break; 
        
        // :::: case c = 12
      case 12:
        
        switch(rs) {
        case 1:
          xs1 = -1.29132926323973; xs2 = 1.07274919050511;
          ds = 0.612343462471593; bs = -0.1466234; cs = 0.520799429444565;
          break; 
        case 2:
          xs1 = -1.28613817258913; xs2 = 1.06794020309288;
          ds = 0.609873158312793; bs = -0.1450065; cs = 0.508257659452333;
          break; 
        case 3:
          xs1 = -1.2809840885255; xs2 = 1.06327166136463;
          ds = 0.607437076594147; bs = -0.1433755; cs = 0.495840192034889;
          break; 
        case 4:
          xs1 = -1.27587034201765; xs2 = 1.05874461593681;
          ds = 0.605036894576096; bs = -0.141732; cs = 0.483558239864205;
          break; 
        case 5:
          xs1 = -1.2708002207036; xs2 = 1.05435978185587;
          ds = 0.60267420115311; bs = -0.1400777; cs = 0.471422569262505;
          break; 
        case 6:
          xs1 = -1.25833676968063; xs2 = 1.04402152881578;
          ds = 0.600350489088719; bs = -0.1371579; cs = 0.459443446933736;
          break; 
        case 7:
          xs1 = -1.24621397243302; xs2 = 1.03457038056435;
          ds = 0.594720600646941; bs = -0.1329654; cs = 0.43024285064609;
          break; 
        case 8:
          xs1 = -1.23447538113237; xs2 = 1.02599072743153;
          ds = 0.589361346084605; bs = -0.1287621; cs = 0.402214731811048;
          break; 
        case 9:
          xs1 = -1.2231587473242; xs2 = 1.01825565236998;
          ds = 0.584286641980104; bs = -0.1245744; cs = 0.375467849267358;
          break; 
        case 10:
          xs1 = -1.21229500167916; xs2 = 1.01132853196097;
          ds = 0.579505495631091; bs = -0.1204272; cs = 0.3500830685534;
          break;
        case 11:
          xs1 = -1.20190761255587; xs2 = 1.00516495185768;
          ds = 0.575022040219793; bs = -0.1163431; cs = 0.326113166754704;
          break; 
        case 12:
          xs1 = -1.19201235420206; xs2 = 0.999714772270228;
          ds = 0.570835795267266; bs = -0.1123422; cs = 0.303584027527563;
          break; 
        case 13:
          xs1 = -1.18261746880836; xs2 = 0.994924184943499;
          ds = 0.566942105701646; bs = -0.1084416; cs = 0.282496972308963;
          break;
        }
        
        break; 
        
        // :::: case c = 13
      case 13:
        
        switch(rs) {
        case 1:
          xs1 = -1.28655582700163; xs2 = 1.07647465447435;
          ds = 0.611871386922585; bs = -0.1408246; cs = 0.519870380920305;
          break; 
        case 2:
          xs1 = -1.28154840051961; xs2 = 1.07183615833555;
          ds = 0.609492825636539; bs = -0.1393243; cs = 0.507826898730495;
          break; 
        case 3:
          xs1 = -1.27657886636042; xs2 = 1.06732706263568;
          ds = 0.607146724248642; bs = -0.1378118; cs = 0.495898466024089;
          break; 
        case 4:
          xs1 = -1.27165014954234; xs2 = 1.0629482967268;
          ds = 0.604834561111994; bs = -0.1362885; cs = 0.484095058406471;
          break; 
        case 5:
          xs1 = -1.26676512533505; xs2 = 1.05870050310292;
          ds = 0.602557735515937; bs = -0.1347559; cs = 0.472426267971211;
          break; 
        case 6:
          xs1 = -1.25476198614147; xs2 = 1.04865564704668;
          ds = 0.600317561439444; bs = -0.1320521; cs = 0.46090125934895;
          break; 
        case 7:
          xs1 = -1.24309090604374; xs2 = 1.03942859561206;
          ds = 0.594885265595184; bs = -0.1281708; cs = 0.432773607999574;
          break; 
        case 8:
          xs1 = -1.2317893519808; xs2 = 1.03100648779846;
          ds = 0.589705827745203; bs = -0.1242796; cs = 0.405719058035706;
          break; 
        case 9:
          xs1 = -1.22088962757408; xs2 = 1.02336672552492;
          ds = 0.58479157199926; bs = -0.1204009; cs = 0.379836824482981;
          break; 
        case 10:
          xs1 = -1.21041810016443; xs2 = 1.01647826060472;
          ds = 0.58015057929608; bs = -0.1165563; cs = 0.355202317970846;
          break;
        case 11:
          xs1 = -1.20039472623668; xs2 = 1.01030314044675;
          ds = 0.575786721066262; bs = -0.1127653; cs = 0.331866834013155;
          break; 
        case 12:
          xs1 = -1.19083289459953; xs2 = 1.00479818801666;
          ds = 0.571699872686393; bs = -0.1090455; cs = 0.309858369121802;
          break; 
        case 13:
          xs1 = -1.18173957387639; xs2 = 0.999916694352547;
          ds = 0.567886271347128; bs = -0.1054118; cs = 0.289183379582817;
          break;
        }
        
        break;
        
        // :::: case c = 14
      case 14:
        
        switch(rs) {
        case 1:
          xs1 = -1.2823185235036; xs2 = 1.07981850657906;
          ds = 0.611464375146415; bs = -0.1356629; cs = 0.519074781554179;
          break; 
        case 2:
          xs1 = -1.27747759809192; xs2 = 1.07533290539069;
          ds = 0.609168190927415; bs = -0.1342637; cs = 0.507474543545775;
          break; 
        case 3:
          xs1 = -1.27267489139212; xs2 = 1.07096722211762;
          ds = 0.606902844175748; bs = -0.1328537; cs = 0.495981368857191;
          break; 
        case 4:
          xs1 = -1.26791299408355; xs2 = 1.06672228862601;
          ds = 0.604669649883991; bs = -0.1314343; cs = 0.484604208581272;
          break; 
        case 5:
          xs1 = -1.26319444434893; xs2 = 1.06259868884805;
          ds = 0.602469852075057; bs = -0.1300066; cs = 0.47335168085274;
          break; 
        case 6:
          xs1 = -1.25160377369568; xs2 = 1.05282211750958;
          ds = 0.600304618711278; bs = -0.1274892; cs = 0.462232034064793;
          break; 
        case 7:
          xs1 = -1.24033574258039; xs2 = 1.04380384660695;
          ds = 0.595049680983107; bs = -0.1238762; cs = 0.435064677751272;
          break; 
        case 8:
          xs1 = -1.22942298324423; xs2 = 1.03553319726363;
          ds = 0.590031942733718; bs = -0.1202539; cs = 0.408885849081852;
          break; 
        case 9:
          xs1 = -1.21889350852383; xs2 = 1.02799101589631;
          ds = 0.585262436179885; bs = -0.1166418; cs = 0.383786554277709;
          break; 
        case 10:
          xs1 = -1.20877011393915; xs2 = 1.0211507238594;
          ds = 0.580748489340541; bs = -0.1130586; cs = 0.35983726168777;
          break;
        case 11:
          xs1 = -1.19907001931437; xs2 = 1.01497958277495;
          ds = 0.576493756544365; bs = -0.1095213; cs = 0.337087526814732;
          break; 
        case 12:
          xs1 = -1.18980476222945; xs2 = 1.00944007949671;
          ds = 0.572498395010177; bs = -0.1060454; cs = 0.315566542654515;
          break; 
        case 13:
          xs1 = -1.18098033183378; xs2 = 1.00449133563607;
          ds = 0.568759360470595; bs = -0.1026443; cs = 0.295284479353118;
          break;
        }
        
        break; 
      }
      
      const double ts = std::sqrt(2.0) * a;
      const double t = -b / ts;
      const double d1 = pbdv(-c-1, t);
      const double d21 = pbdv(-c-2, t) / d1;
      const double d31 = (1.0 - t * d21);
      
      const double mu = ((double)c + 1.0) * d21 / ts;
      // const double s2 = ((double)c + 1.0) * ((double)c + 2.0) * d31 / (ts * ts) - mu * mu; 
      const double s2 = ((double)c + 1.0) * d31 / (ts * ts) - mu * mu; 
      
      // Rcpp::Rcout << "\n mu: " << mu;
      // Rcpp::Rcout << "\n s2: " << s2;
      // Rcpp::Rcout << "\n d1: " << d1;
      // 
      // Rcpp::Rcout << "\n d31: " << d31;
      
      const double s = std::sqrt(s2);
      const double w = 1.0 / (ts * s);
      
      double u = R::rnorm(0.0, w);
      double kf = 0.0, kg = 0.0;
      
      out = u * s + mu;
      
      if ((xs1 <= u) && (u <= xs2)) 
      {  
        // :::::::::::: 
        // STEP 1
        
        return out;
      } 
      else 
      {
        // :::::::::::: 
        // STEP 2
        
        kf = s * std::pow(ts, c + 1) / (std::exp(0.25 * t * t) * d1 * factorial(c));
        kg = w * s2pi;
        
        if (u > -mu/s) 
        {
          double q = kf * kg * std::pow(out, c) * std::exp(out * (b - ts * ts * mu) + a * a * mu * mu);
          if (R::runif(0, 1) <= q) 
            return out;
        }
      }
      
      // :::::::::::: 
      // STEP 3
      
      int i = 0;
      double e, x, f, g, dlap;
      
      while (i < 1e+16) 
      {
        i += 1;
        e = R::rexp(1);
        u = R::runif(0, 1);
        u = u + u - 1.0;
        
        if (u < 0.0) 
        {
          x = bs - ds * e;
        } 
        else 
        {
          x = bs + ds * e;
        }
        out = x * s + mu;
        
        if ((xs1 <= x) && (x <= xs2)) 
        {
          f = kf * std::pow(out, c) * std::exp(-a * a * out * out + b * out);
          // f = kf / s * std::pow(x, c) * std::exp(-a * a * x * x + b * x);
          
          g = std::exp(-0.5 * x * x / (w * w)) / kg;
          dlap = cs / s2pi * std::exp(-std::abs(x - bs) / ds);
          
          if (std::abs(u) <= ((f - g) / dlap)) 
            return out;
        }
      }
    }
  }
  
  Rcpp::Rcout << "\n Warning: returned value 0 \n";
  return 0.0;
}
